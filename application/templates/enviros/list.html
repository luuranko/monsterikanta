{% extends "layout.html" %}
{% block body %}


<div class="row">
  <div class="col-auto">
    <h6>Users ranked by amount of environments created</h6>
  </div>
</div> 
<div class="row">
  <div class="col-auto">
    <button type="button" class="btn btn-light" data-toggle="collapse" data-target="#most_enviros">Show Ranking</button>
  </div>
</div>
<br>

<div class="row">
<div class="col-auto">
<div id="most_enviros" class="collapse">
  <table class="table table-light table-sm">
    <thead>
      <tr>
        <th scope="col" class="text text-center">User</th>
        <th scope="col" class="text text-center">Environments</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td class="text text-center">{{ user.name }}</td>
        <td class="text text-center">{{ user.id }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</div>
</div>

<h5>Search</h5>
<form method="POST" action="{{ url_for('enviros_index') }}">
  <div class="form-group row">
    <div class="col-3">
      {{ form.name(placeholder="Name", id="name", class="form-control", maxlength="35") }}
    </div>
    <div class="col-3">
      {{ form.etype(id="etype", class="form-control") }}
    </div>
    <div class="col-3">
      {{ form.whose(id="whose", class="form-control") }}
    </div>
    <div class="col-3">
      {{ form.owner(placeholder="Creator", id="owner", class="form-control") }}
    </div>
    <div class="col-2">
    </div>
  </div>
  <button type="submit" class="btn btn-light">Search</button>
</form>
<br>


<h5>Environments</h5>
{% if enviros %}

<div class="row">
<div class="col-auto">
<table class="table table-light">
  <thead>
    <tr>
      <th scope="col" class="text text-center">Environment</th>
      <th scope="col" class="text text-center">Type</th>
      <th scope="col" class="text text-center">Public</th>
      <th scope="col" class="text text-center">Creator</th>
      <th scope="col" class="text text-center"></th>
    </tr>
  </thead>
  <tbody>
    {% for enviro in enviros %}
    <tr>
      <td class="text text-center"> {{ enviro.name }} </td>
      <td class="text text-center"> {{ enviro.etype }} </td>
      {% if enviro.public %}
      <td class="text text-center"> Yes </td>
      {% else %}
      <td class="text text-center"> No </td>
      {% endif %}
      <td class="text text-center"> {{ enviro.account_name }} </td>
      <td>
        <form method="GET" action="{{ url_for('enviros_show', enviro_id=enviro.id) }}">
          <button type="submit" class="btn btn-outline-dark btn-sm">Show</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
</div>
{% else %}
<p>Nothing here yet. <a href="{{ url_for('enviros_form') }}">Create a new environment.</a></p>
{% endif %}

{% endblock %}
